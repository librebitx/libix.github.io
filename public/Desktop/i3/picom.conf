# ==========================================
# 1. 核心后端与性能 (消除撕裂的关键)
# ==========================================
backend = "glx";
vsync = true;

# GLX 优化选项
glx-no-stencil = true;
glx-no-rebind-pixmap = true;

use-damage = false;

# 全屏应用优化
unredir-if-possible = false;
unredir-if-possible-exclude = [
    "class_g = 'Vlc'"
];

# ==========================================
# 2. 透明度
# ==========================================
# 聚焦窗口完全不透明
active-opacity = 1.0;
# 未聚焦窗口透明度 (0.90 = 90% 不透明)
inactive-opacity = 0.85;
# 窗口边框透明度
frame-opacity = 1.0;
# 即使设置了透明，也不要让它影响到“不活动”状态的判断
inactive-opacity-override = false;

# 强制不透明规则
opacity-rule = [
  "100:class_g = 'Firefox'",
  "100:class_g = 'Google-chrome'",
  "100:class_g = 'Chromium'",
  "100:class_g = 'Vlc'",
  "100:class_g = 'fcitx5'",
  "100:fullscreen"
];

# ==========================================
# 3. 基础检测设置
# ==========================================
# 确保 Dunst 等程序的自带圆角/透明背景能正确显示，不会变成黑块
detect-client-opacity = true;
detect-rounded-corners = true;

# ==========================================
# 4. 关闭不需要的特效
# ==========================================
shadow = false;          # 关闭阴影
fading = false;          # 关闭淡入淡出
corner-radius = 0;       # 关闭 Picom 圆角处理

corner-radius-rules = [
  "20:class_g = 'Dunst'",
  "20:class_g = 'dunst'"
];

# ==========================================
# 5. 窗口类型特殊处理
# ==========================================
wintypes:
{
  dock = { shadow = false; };
  dnd = { shadow = false; };
  notification = { opacity = 1.0; shadow = false; };
};
